{"version":3,"sources":["../../src/Bot/SharedProps.js"],"names":["SharedPropsFactory","constructor","store","on","change","storeUpdateListener","log","sourceId","Promise","resolve","reject","Firebase","fdb","collection","add","get","console","Date","SharedProps"],"mappings":";;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AAEA;;;;AACA;;;;;;AAEA,MAAMA,kBAAN,CAAyB;AACvBC,gBAAc;AACZ;AACA,SAAKC,KAAL,GAAa,uBAAQ,EAAR,CAAb;AACA;AACA;AACA;AACA;AACA,SAAKA,KAAL,CAAWC,EAAX,CAAc,QAAd,EAAwBC,UAAU;AAChC,WAAKC,mBAAL;AACD,KAFD;AAGD;;AAEDC,MAAIC,QAAJ,EAAc;AACZ,QAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AAC/B,UAAIH,QAAJ,EAAc;AACZI,2BAASC,GAAT,CAAaC,UAAb,CAAwB,OAAxB,EAAiCC,GAAjC,CAAqC,KAAKZ,KAAL,CAAWa,GAAX,CAAe,CAACR,QAAD,CAAf,CAArC;AACAS,gBAAQV,GAAR,CAAY,4BAAZ,EAA0CC,QAA1C,EAAoD,IAAIU,IAAJ,EAApD;AACD;AACD;AACAD,cAAQV,GAAR,CAAY,4BAAZ,EAA0C,IAAIW,IAAJ,EAA1C;AACD,KAPD;AAQD;;AAEDZ,wBAAsB;AACpB;AACAW,YAAQV,GAAR,CAAY,6BAAZ,EAA2C,IAAIW,IAAJ,EAA3C;AACD;AA3BsB;;AA8BzB,MAAMC,cAAc,IAAIlB,kBAAJ,EAApB;;QAGEkB,W,GAAAA,W","file":"SharedProps.js","sourcesContent":["import Store from \"../Services/Store\";\nimport fs from \"fs-extra\";\nimport mkdirp from \"mkdirp\";\nimport path from \"path\";\nimport uuid from \"uuid\";\n\nimport config from \"../Config/Line\";\n\nimport Firebase from \"../Services/Firebase\";\nimport observe from \"observe\";\n\nclass SharedPropsFactory {\n  constructor() {\n    // this.store = {};\n    this.store = observe({});\n    // this.store = new Proxy({}, {\n    //   set: this._set,\n    //   get: this._get\n    // });\n    this.store.on(\"change\", change => {\n      this.storeUpdateListener();\n    });\n  }\n\n  log(sourceId) {\n    new Promise((resolve, reject) => {\n      if (sourceId) {\n        Firebase.fdb.collection(\"Props\").add(this.store.get([sourceId]));\n        console.log(\"[SharedProps] Props logged\", sourceId, new Date());\n      }\n      // Firebase.fdb.collection(\"Store\").add(this.store.get(\"\"));\n      console.log(\"[SharedProps] Store logged\", new Date());\n    });\n  }\n\n  storeUpdateListener() {\n    // Firebase.rdb.ref(\"SharedProps\").set(this.store.get(\"\"));\n    console.log(\"[SharedProps] Store updated\", new Date());\n  }\n}\n\nconst SharedProps = new SharedPropsFactory();\n\nexport {\n  SharedProps\n};\n"]}