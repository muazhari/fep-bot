{"version":3,"sources":["../../../../src/Bot/Helper/CloudinaryUtils/index.js"],"names":["uploadQueue","upload","url","filename","Promise","resolve","reject","cloudinary","uploader","public_id","then","file","console","log","catch","err","warn","waitForAllUploads","type","limit","fileMeta","callback","ids","Object","keys","length","join"],"mappings":";;;;;;;;AAAA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,MAAMA,cAAc,EAApB;;AAEA,MAAMC,SAAS,CAACC,GAAD,EAAMC,QAAN,KAAmB;AAChC,SAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtCC,yBAAWC,QAAX,CACGP,MADH,CACUC,GADV,EACe,EAAEO,WAAWN,QAAb,EADf,EAEGO,IAFH,CAEQC,QAAQ;AACZC,cAAQC,GAAR,CAAY,0BAAZ;AACAD,cAAQC,GAAR,CAAY,OAAOF,KAAKF,SAAxB;AACAG,cAAQC,GAAR,CAAY,OAAOF,KAAKT,GAAxB;AACAG,cAAQM,IAAR;AACD,KAPH,EAQGG,KARH,CAQSC,OAAO;AACZH,cAAQC,GAAR,CAAY,0BAAZ;AACA,UAAIE,GAAJ,EAAS;AACPH,gBAAQI,IAAR,CAAaD,GAAb;AACAT,eAAOS,GAAP;AACD;AACF,KAdH;AAeD,GAhBM,CAAP;AAiBD,CAlBD;;AAoBA,MAAME,oBAAoB,CAACC,IAAD,EAAOC,KAAP,EAAcC,QAAd,EAAwBC,QAAxB,KAAqC;AAC7DrB,cAAYkB,IAAZ,iBACKlB,YAAYkB,IAAZ,CADL,EAEKE,QAFL;AAIA,QAAME,MAAMC,OAAOC,IAAP,CAAYxB,YAAYkB,IAAZ,CAAZ,CAAZ;AACA,MAAII,IAAIG,MAAJ,KAAeN,KAAnB,EAA0B;AACxBP,YAAQC,GAAR,CAAY,6BAA6BS,IAAII,IAAJ,CAAS,GAAT,CAA7B,GAA6C,iBAAzD;AACAL;AACD;AACF,CAVD;;kBAYe;AACbpB,QADa;AAEbgB;AAFa,C","file":"index.js","sourcesContent":["import { SharedProps } from \"../../../Bot\";\nimport storage from \"node-persist\";\nimport Store from \"../../../Services/Store\";\nimport FEPStoreCRUD from \"../../../Bot/Helper/FEPStoreCRUD\";\nimport cloudinary from \"cloudinary\";\nimport fs from \"fs-extra\";\nimport request from \"request\";\nimport cp from \"child_process\";\nimport path from \"path\";\n\nconst uploadQueue = {};\n\nconst upload = (url, filename) => {\n  return new Promise((resolve, reject) => {\n    cloudinary.uploader\n      .upload(url, { public_id: filename })\n      .then(file => {\n        console.log(\"** File Upload (Promise)\");\n        console.log(\"* \" + file.public_id);\n        console.log(\"* \" + file.url);\n        resolve(file);\n      })\n      .catch(err => {\n        console.log(\"** File Upload (Promise)\");\n        if (err) {\n          console.warn(err);\n          reject(err);\n        }\n      });\n  });\n};\n\nconst waitForAllUploads = (type, limit, fileMeta, callback) => {\n  uploadQueue[type] = {\n    ...uploadQueue[type],\n    ...fileMeta\n  };\n  const ids = Object.keys(uploadQueue[type]);\n  if (ids.length === limit) {\n    console.log(\"**  uploaded all files (\" + ids.join(\",\") + \") to cloudinary\");\n    callback();\n  }\n};\n\nexport default {\n  upload,\n  waitForAllUploads\n};\n"]}