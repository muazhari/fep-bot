{"version":3,"sources":["../../src/Bot/handlerBot.js"],"names":["baseURL","process","env","BASE_URL","batch_list","a","b","c","d","e","command_prefix","destructCommand","chat","prefix","command","slice","length","args","map","item","trim","console","log","handleCommand","features","FEPList","StoreAdvance","Basic","Template","Twibbon","Courses","PosetLattice","commandList","add","upd","update","rem","remove","view","rstore","reset_store","pstore","pre_store","bstore","backup_store","admin","help","button","profile","confirm","bifest","greet","say","twibbon","ready","algo","pl","generate","content_prefix","content_command","content_args","Object","keys","includes","userQueue","userId","queue","increment","decrement","handlerBot","Bot","eventListener","props","event","type","message","handleText","handleImage","handleVideo","handleAudio","handleLocation","handleSticker","Error","JSON","stringify","client","getProfile","joined","members","then","replyText","displayName","source","data","postback","params","objectData","parse","Features","listen","beacon","replyToken","splittedChat","text","split","isTextCommand","dialogFlow","getContent","contentProvider","downloadPath","path","join","__dirname","id","previewPath","downloadContent","cp","execSync","originalPath","originalContentUrl","basename","previewImageUrl","catch","err","Promise","resolve","insert","sendMessage","title","address","latitude","longitude"],"mappings":"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","file":"handlerBot.js","sourcesContent":["import fs from \"fs-extra\";\nimport path from \"path\";\nimport cp from \"child_process\";\nimport { shared_props } from \"./internal\";\n\n// base URL for webhook server\nexport const baseURL = process.env.BASE_URL;\n\nexport const batch_list = {\n  a: \"22 - 27 JULI 2019\",\n  b: \"29 JULI - 3 AGUSTUS 2019\",\n  c: \"5 - 10 AGUSTUS 2019\",\n  d: \"19 - 24 AGUSTUS 2019\",\n  e: \"26 - 03 SEPTEMBER 2019\"\n};\n\nexport const command_prefix = \"/\";\n\nconst destructCommand = chat => {\n  const prefix = chat[0][0];\n  const command = chat[0].slice(1, chat[0].length);\n  const args = chat.slice(1, chat.length).map(item => item.trim());\n\n  console.log({ prefix, command, args });\n  return { prefix, command, args };\n};\n\nconst handleCommand = (features, command) => {\n  const {\n    FEPList,\n    StoreAdvance,\n    Basic,\n    Template,\n    Twibbon,\n    Courses,\n    PosetLattice\n  } = features;\n\n  const commandList = {\n    add: FEPList.add,\n    upd: FEPList.update,\n    rem: FEPList.remove,\n    view: FEPList.view,\n    rstore: StoreAdvance.reset_store,\n    pstore: StoreAdvance.pre_store,\n    bstore: StoreAdvance.backup_store,\n    \"]]\": Basic.admin,\n    help: Basic.help,\n    button: Template.button,\n    profile: Basic.profile,\n    confirm: Template.confirm,\n    bifest: Template.bifest,\n    greet: Basic.greet,\n    say: Basic.say,\n    twibbon: Twibbon.ready,\n    algo: Courses.algo,\n    pl: PosetLattice.generate\n  };\n\n  const {\n    prefix: content_prefix,\n    command: content_command,\n    args: content_args\n  } = destructCommand(command);\n\n  if (Object.keys(commandList).includes(content_command)) {\n    if (commandList[content_command].length >= 1) {\n      commandList[content_command](content_args);\n    } else {\n      commandList[content_command]();\n    }\n  }\n};\n\nconst userQueue = userId => {\n  const queue = {};\n\n  const increment = () => {\n    if (!queue[userId]) {\n      queue[userId] = 0;\n    }\n    queue[userId] += 1;\n  };\n\n  const decrement = () => {\n    if (!queue[userId]) {\n      queue[userId] = 0;\n    }\n    if (queue[userId] >= 1) {\n      queue[userId] -= 1;\n    }\n  };\n\n  return { increment, decrement };\n};\n\nexport const handlerBot = Bot => {\n  eventListener(Bot.props.event);\n\n  const eventListener = event => {\n    console.log(event);\n    // hidden error, need fix\n    // const Bot = new Bot({ event });\n    // Bot.log()\n\n    // const whitelist = Bot.Features.Access.whitelist();\n    // console.log(whitelist);\n    // const type = whitelist.user || whitelist.room ? event.type : null;\n\n    switch (event.type) {\n      case \"message\":\n        const { message } = event;\n        switch (message.type) {\n          case \"text\":\n            return handleText();\n          case \"image\":\n            return handleImage();\n          case \"video\":\n            return handleVideo();\n          case \"audio\":\n            return handleAudio();\n          case \"location\":\n            return handleLocation();\n          case \"sticker\":\n            return handleSticker();\n          default:\n            throw new Error(`Unknown message: ${JSON.stringify(message)}`);\n        }\n\n      case \"memberJoined\":\n        return Bot.client\n          .getProfile(event.joined.members[0].userId)\n          .then(profile => {\n            Bot.replyText(\n              `Welcome ${profile.displayName}! Jangan lupa cek notes di group ya!`\n            );\n          });\n\n      case \"follow\":\n        return Bot.replyText(\"Got followed event\");\n\n      case \"unfollow\":\n        return console.log(`Unfollowed this bot: ${JSON.stringify(event)}`);\n\n      case \"join\":\n        return Bot.replyText(`Joined ${event.source.type}`);\n\n      case \"leave\":\n        return console.log(`Left: ${JSON.stringify(event)}`);\n\n      case \"postback\":\n        let { data } = event.postback;\n        if (data === \"DATE\" || data === \"TIME\" || data === \"DATETIME\") {\n          data += `(${JSON.stringify(event.postback.params)})`;\n        }\n\n        const objectData = JSON.parse(data);\n\n        const { Twibbon } = Bot.Features;\n        Twibbon.listen(objectData);\n\n        break;\n\n      case \"beacon\":\n        return Bot.replyText(`Got beacon: ${event.beacon}`);\n\n      default:\n        throw new Error(`Unknown event: ${JSON.stringify(event)}`);\n    }\n  };\n\n  const handleText = () => {\n    const { message, replyToken, source } = Bot.props.event;\n\n    // The text query request.\n    const splittedChat = message.text.split(\" \");\n    const isTextCommand = splittedChat[0][0] === command_prefix;\n    if (isTextCommand) {\n      handleCommand(Bot.Features, splittedChat);\n    } else {\n      // hidden error, need fix\n      Bot.dialogFlow.listen();\n    }\n  };\n\n  const handleImage = () => {\n    const { message, replyToken } = Bot.props.event;\n    let getContent;\n\n    if (message.contentProvider.type === \"line\") {\n      const downloadPath = path.join(\n        __dirname,\n        \"../../src/Bot/Assets/downloaded/images\",\n        `${message.id}.jpg`\n      );\n      const previewPath = path.join(\n        __dirname,\n        \"../../src/Bot/Assets/downloaded/images\",\n        `${message.id}-preview.jpg`\n      );\n\n      getContent = () => {\n        return Bot.downloadContent(message.id, downloadPath)\n          .then(downloadPath => {\n            console.log(\"premature_resolve\", downloadPath);\n            cp.execSync(\n              `convert -resize 240x jpg:${downloadPath} jpg:${previewPath}`\n            );\n            return {\n              originalPath: downloadPath,\n              previewPath: previewPath,\n              originalContentUrl: `${baseURL}/downloaded/images/${path.basename(\n                downloadPath\n              )}`,\n              previewImageUrl: `${baseURL}/downloaded/images/${path.basename(\n                previewPath\n              )}`\n            };\n          })\n          .catch(err => {\n            throw err;\n          });\n      };\n    } else if (message.contentProvider.type === \"external\") {\n      getContent = () => {\n        return Promise.resolve(message.contentProvider);\n      };\n    }\n\n    // Twibbon switch\n    const { Twibbon } = Bot.Features;\n    Twibbon.insert(getContent);\n  };\n\n  const handleVideo = () => {\n    const { message, replyToken } = Bot.props.event;\n    let getContent;\n    if (message.contentProvider.type === \"line\") {\n      const downloadPath = path.join(\n        __dirname,\n        \"../../src/Bot/Assets/downloaded/videos\",\n        `${message.id}.mp4`\n      );\n      const previewPath = path.join(\n        __dirname,\n        \"../../src/Bot/Assets/downloaded/videos\",\n        `${message.id}-preview.jpg`\n      );\n\n      getContent = Bot.downloadContent(message.id, downloadPath).then(\n        downloadPath => {\n          // FFmpeg and ImageMagick is needed here to run 'convert'\n          // Please consider about security and performance by yourself\n          cp.execSync(`convert mp4:${downloadPath}[0] jpeg:${previewPath}`);\n\n          return {\n            originalContentUrl: `${baseURL}/downloaded/videos/${path.basename(\n              downloadPath\n            )}`,\n            previewImageUrl: `${baseURL}/downloaded/videos/${path.basename(\n              previewPath\n            )}`\n          };\n        }\n      );\n    } else if (message.contentProvider.type === \"external\") {\n      getContent = Promise.resolve(message.contentProvider);\n    }\n\n    return getContent.then(({ originalContentUrl, previewImageUrl }) => {\n      // tBot.sendMessage({\n      //   type: \"video\",\n      //   originalContentUrl,\n      //   previewImageUrl\n      // });\n    });\n  };\n\n  const handleAudio = () => {\n    const { message, replyToken } = Bot.props.event;\n    let getContent;\n    if (message.contentProvider.type === \"line\") {\n      const downloadPath = path.join(\n        __dirname,\n        \"../../src/Bot/Assets/downloaded/audios\",\n        `${message.id}.m4a`\n      );\n\n      getContent = Bot.downloadContent(message.id, downloadPath).then(\n        downloadPath => {\n          return {\n            originalContentUrl: `${baseURL}/downloaded/audios/${path.basename(\n              downloadPath\n            )}`\n          };\n        }\n      );\n    } else {\n      getContent = Promise.resolve(message.contentProvider);\n    }\n\n    return getContent.then(({ originalContentUrl }) => {\n      // Bot.sendMessage({\n      //   type: \"audio\",\n      //   originalContentUrl,\n      //   duration: message.duration\n      // });\n    });\n  };\n\n  const handleLocation = () => {\n    const { message, replyToken } = Bot.props.event;\n    Bot.sendMessage({\n      type: \"location\",\n      title: message.title,\n      address: message.address,\n      latitude: message.latitude,\n      longitude: message.longitude\n    });\n  };\n\n  const handleSticker = () => {\n    const { message, replyToken } = Bot.props.event;\n    // Bot.sendMessage({\n    //   type: \"sticker\",\n    //   packageId: message.packageId,\n    //   stickerId: message.stickerId\n    // });\n  };\n};\n"]}